<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Select All that Apply Questions • satpt</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="../deps/MathJax-3.2.2/tex-chtml.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Select All that Apply Questions">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">satpt</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/satpt.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/select_all_apply.html">Select All that Apply Questions</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Select All that Apply Questions</h1>
            
      

      <div class="d-none name"><code>select_all_apply.Rmd</code></div>
    </div>

    
    
<p>Not every survey question will contain responses that are mutually
exclusive. Specifically, it is quite common for surveys to include
questions that state, “Select all the responses that all.” An example of
this type of question can be seen on the first question of the
<em>EIN</em> survey titled <a href="https://ein.idsociety.org/surveys/survey/166/" class="external-link"><em>Difficult
Diagnoses</em></a>. So, the focus of this document will be explore we
can use <code>satpt</code> to determine if saturation has been achieved
for these types of questions.</p>
<p>We’ll start off by call the <code>library</code> function to
<code>satpt</code> to obtain all the functionality of the package</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://deboonstra.github.io/satpt/">satpt</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'satpt'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     simulate</span></span></code></pre></div>
<p>and load in the example <a href="https://deboonstra.github.io/satpt/reference/ein.html"><em>EIN</em></a>
data.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ein</span><span class="op">)</span></span></code></pre></div>
<p>When we examine the first six and last six of the responses to
question one, we see the responses to this “select that all apply”
question are separated by the vertical pipe operator
(<code>"|"</code>).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ein</span><span class="op">$</span><span class="va">q1</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Broadrange|Wholegenome|MNGS" "Broadrange|Wholegenome|MNGS"</span></span>
<span><span class="co">#&gt; [3] "Broadrange|MNGS"             "Broadrange"                 </span></span>
<span><span class="co">#&gt; [5] "MNGS"                        "Broadrange|Other"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">ein</span><span class="op">$</span><span class="va">q1</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Broadrange"                  "Broadrange"                 </span></span>
<span><span class="co">#&gt; [3] "Broadrange"                  "Broadrange|MNGS"            </span></span>
<span><span class="co">#&gt; [5] "Broadrange|Wholegenome|MNGS" "None"</span></span></code></pre></div>
<p>From the original survey, <a href="https://ein.idsociety.org/surveys/survey/166/" class="external-link"><em>Difficult
Diagnoses</em></a>, we know that the reported values relate to survery
responses in this manner.</p>
<ul>
<li>
<code>"Broadrange"</code>: Broad range 16S rRNA gene sequencing</li>
<li>
<code>"Wholegenome"</code>: Whole genome sequencing</li>
<li>
<code>"MNGS"</code>: Metagenomic next-generation sequencing
(mNGS)</li>
<li>
<code>"None"</code>: None of the above</li>
<li>
<code>"Other"</code>: Other, specify</li>
</ul>
<p>So, we need to split the string of reponses based on the vertical
pipe delimiter for each response.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">q1_split</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">ein</span><span class="op">$</span><span class="va">q1</span>, split <span class="op">=</span> <span class="st">"|"</span>, fixed <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>With each response to the survey being represented as an element of
character vectors in <code>q1</code>, we are going to create five
indicator functions that denote whether one of the options were selected
for a given response to the survey. We are transforming to indicator
functions because the methodology proposed in the paper that accompanies
this package demonstrates that “select all that apply” questions can be
viewed a collection Poisson distributions. When each one of these
distributions are conditioned on by the sum of Poisson distributions the
result is a binomial distribution. So, the code below demonstrates one
way to create these indicators functions for each of the possible
response fields.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Identifying response field selected for each observation</span></span>
<span><span class="va">q1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span></span>
<span>  X <span class="op">=</span> <span class="va">q1_split</span>,</span>
<span>  FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">broadrange</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span>test <span class="op">=</span> <span class="st">"Broadrange"</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">x</span>, yes <span class="op">=</span> <span class="fl">1</span>, no <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span>      <span class="va">wholegenome</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span>test <span class="op">=</span> <span class="st">"Wholegenome"</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">x</span>, yes <span class="op">=</span> <span class="fl">1</span>, no <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span>      <span class="va">mngs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span>test <span class="op">=</span> <span class="st">"MNGS"</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">x</span>, yes <span class="op">=</span> <span class="fl">1</span>, no <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span>      <span class="va">none</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span>test <span class="op">=</span> <span class="st">"None"</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">x</span>, yes <span class="op">=</span> <span class="fl">1</span>, no <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span>      <span class="va">other</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span>test <span class="op">=</span> <span class="st">"Other"</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">x</span>, yes <span class="op">=</span> <span class="fl">1</span>, no <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>      <span class="va">broadrange</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span>      <span class="va">wholegenome</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span>      <span class="va">mngs</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span>      <span class="va">none</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span>      <span class="va">other</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>      broadrange <span class="op">=</span> <span class="va">broadrange</span>,</span>
<span>      wholegenome <span class="op">=</span> <span class="va">wholegenome</span>,</span>
<span>      mngs <span class="op">=</span> <span class="va">mngs</span>,</span>
<span>      none <span class="op">=</span> <span class="va">none</span>,</span>
<span>      other <span class="op">=</span> <span class="va">other</span></span>
<span>    <span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine vector of indicator values into a single data object</span></span>
<span><span class="va">q1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span>what <span class="op">=</span> <span class="st">"rbind"</span>, args <span class="op">=</span> <span class="va">q1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Turning indicator functions in factor</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">q1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">q1</span><span class="op">[</span>, <span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">q1</span><span class="op">[</span>, <span class="va">j</span><span class="op">]</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"No"</span>, <span class="st">"Yes"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Add data collection period variable to data</span></span>
<span><span class="va">q1</span><span class="op">$</span><span class="va">wave</span> <span class="op">&lt;-</span> <span class="va">ein</span><span class="op">$</span><span class="va">wave</span></span></code></pre></div>
<p>The “select all that apply” response are now transformed into a
collection of indicator functions, where the value <code>"Yes"</code>
denotes that response field was selected and <code>"No"</code> denotes
the response field was <strong>not</strong> selected. These responses
were collected in different data collection periods due to non-response
of previous collection periods. The <code>"wave"</code> variable was
added to the data, so we may conduct saturation point analysis on each
of the response fields while controlling for potiental response
bias.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">q1</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'data.frame':    643 obs. of  6 variables:</span></span>
<span><span class="co">#&gt;  $ broadrange : Factor w/ 2 levels "No","Yes": 2 2 2 2 1 2 2 2 2 2 ...</span></span>
<span><span class="co">#&gt;  $ wholegenome: Factor w/ 2 levels "No","Yes": 2 2 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">#&gt;  $ mngs       : Factor w/ 2 levels "No","Yes": 2 2 2 1 2 1 1 1 2 2 ...</span></span>
<span><span class="co">#&gt;  $ none       : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">#&gt;  $ other      : Factor w/ 2 levels "No","Yes": 1 1 1 1 1 2 1 1 1 1 ...</span></span>
<span><span class="co">#&gt;  $ wave       : num  2 3 3 2 2 3 3 3 2 3 ...</span></span></code></pre></div>
<p>Using the <a href="https://deboonstra.github.io/satpt/reference/satpt.html"><code>satpt::satpt()</code></a>
function on each of the indicator functions of the responses field, we
will perform the saturation point analysis.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span>mode <span class="op">=</span> <span class="st">"list"</span>, length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">q1</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">q1</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">q1</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">q1</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">res</span><span class="op">[[</span><span class="va">j</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">satpt</span><span class="fu">::</span><span class="fu"><a href="../reference/satpt.html">satpt</a></span><span class="op">(</span></span>
<span>    y <span class="op">=</span> <span class="va">q1</span><span class="op">[</span>, <span class="va">j</span><span class="op">]</span>,</span>
<span>    by <span class="op">=</span> <span class="va">q1</span><span class="op">$</span><span class="va">wave</span>,</span>
<span>    dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"by"</span> <span class="op">=</span> <span class="st">"Data collection period"</span>,</span>
<span>      <span class="st">"y"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Responses to survey: "</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">q1</span><span class="op">)</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Finally, in the results below, we see that each response field from
the “select all that apply” question achieved saturation with a
saturation threshold of 0.05. Thus, this question has achieved
saturation.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">saturation</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span></span>
<span>  X <span class="op">=</span> <span class="va">res</span>,</span>
<span>  FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">out</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">$</span><span class="va">saturation</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span>
<span><span class="va">saturation</span></span>
<span><span class="co">#&gt;  broadrange wholegenome        mngs        none       other </span></span>
<span><span class="co">#&gt;        TRUE        TRUE        TRUE        TRUE        TRUE</span></span></code></pre></div>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by D. Erik Boonstra, Joseph E. Cavanaugh.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
